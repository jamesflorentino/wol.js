<!DOCTYPE html>  <html> <head>   <title>entity.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="entity.html">                 entity.js               </a>                                           <a class="source" href="events.html">                 events.js               </a>                                           <a class="source" href="game.html">                 game.js               </a>                                           <a class="source" href="grid.html">                 grid.js               </a>                                           <a class="source" href="keys.html">                 keys.js               </a>                                           <a class="source" href="tile.html">                 tile.js               </a>                                           <a class="source" href="utils.html">                 utils.js               </a>                                           <a class="source" href="wol.html">                 wol.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               entity.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h1>wol.entity</h1>

<p>And entity is an element that interacts with other entities in the game.
A hero is an entity and so is an enemy. Entities can have prototype properties and
methods.</p>

<hr />             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nx">define</span><span class="p">([</span>

    <span class="s1">&#39;wol/wol&#39;</span><span class="p">,</span>
    <span class="s1">&#39;wol/events&#39;</span>

<span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">wol</span><span class="p">,</span> <span class="nx">Events</span><span class="p">)</span> <span class="p">{</span>

    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>spritesheet (component)</h2>

<p>A spritesheet component allows the entity to have the API
for animation playback.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">wol</span><span class="p">.</span><span class="nx">components</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;spritesheet&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">entity</span><span class="p">,</span> <span class="nx">spritesheet</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>The animation will be resonsible</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">animation</span> <span class="o">=</span> <span class="nx">wol</span><span class="p">.</span><span class="nx">create</span><span class="p">.</span><span class="nx">animation</span><span class="p">(</span><span class="nx">spritesheet</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">entity</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">animation</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <h3>entity.play (frameName)</h3>

<p>Forwards the timeline of the spritesheet to a certain frame name.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">entity</span><span class="p">.</span><span class="nx">play</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frame</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">animation</span><span class="p">.</span><span class="nx">gotoAndPlay</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">animation</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">entity</span><span class="p">;</span>
        <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h3>entity.stop (frameName)</h3>

<p>Halts the animation to a certain keyframe name.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">entity</span><span class="p">.</span><span class="nx">stop</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">frame</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">animation</span><span class="p">.</span><span class="nx">gotoAndStop</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">animation</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
            <span class="k">return</span> <span class="nx">entity</span><span class="p">;</span>
        <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <h3>entity.sequence(animA, animB)</h3>

<p>Instructs the bitmap animation to play the next animation after one
finishes.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">entity</span><span class="p">.</span><span class="nx">sequence</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">fromA</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span> <span class="nx">fromA</span> <span class="o">=</span> <span class="nx">animation</span><span class="p">.</span><span class="nx">spriteSheet</span><span class="p">.</span><span class="nx">getAnimation</span><span class="p">(</span><span class="nx">from</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">fromA</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="nx">to</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="nx">entity</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h2>events (component)</h2>

<p>Enables the entity to have event emitters that can be used to do a 
subscription based event management.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">wol</span><span class="p">.</span><span class="nx">components</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;events&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">entity</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">events</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Events</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h3>entity.on (name, callback)</h3>

<p>Binds callback function to an event type.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">entity</span><span class="p">.</span><span class="nx">on</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">events</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">cb</span><span class="p">);</span>
        <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h3>entity.off (name, callback)</h3>

<p>Removes a callback function from an event type. If no callback is provided,
it will clear all the subscribed events. If no event name is specified,
it will clear all callbacks in the event manager.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">entity</span><span class="p">.</span><span class="nx">off</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">events</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">cb</span><span class="p">);</span>
        <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <h3>entity.emit(data)</h3>

<p>Dispatches the callback functions from the event manager..</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">entity</span><span class="p">.</span><span class="nx">emit</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">events</span><span class="p">.</span><span class="nx">emit</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">events</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="p">};</span>
    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h2>wol.Entity (Class)</h2>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="nx">wol</span><span class="p">.</span><span class="nx">Entity</span> <span class="o">=</span> <span class="nx">wol</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h3>entity.init()</h3>

<p>When an entity is instantiated, we create a list of <code>._components</code> for component
keeping. That way we have a list of all components that are installed to our
entity, and will prevent overwriting of previously assigned components.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_components</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>This container is where all our visual animations and graphics will be placed.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">this</span><span class="p">.</span><span class="nx">container</span> <span class="o">=</span> <span class="nx">wol</span><span class="p">.</span><span class="nx">create</span><span class="p">.</span><span class="nx">container</span><span class="p">();</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h3>entity.LEFT</h3>

<p>A static property that lets us choose which direction a unit could face.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">LEFT</span><span class="o">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <h3>entity.RIGHT</h3>

<p>A static property that lets us choose which direction a unit could face.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">RIGHT</span><span class="o">:</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <h3>entity.flip(direction)</h3>

<p>Tells the entity to face a certain direction.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">flip</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">direction</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>this.container.scaleX = direction === this.LEFT ? -1 : 1;</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">this</span><span class="p">.</span><span class="nx">container</span><span class="p">.</span><span class="nx">scaleX</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <h3>entity.addComponent(name)</h3>

<p>Adds component to the entity. This function prevents having the entity being assigned
with components twice.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">addComponent</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">component</span><span class="p">,</span> <span class="nx">args</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_components</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">component</span> <span class="o">=</span> <span class="nx">wol</span><span class="p">.</span><span class="nx">components</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
                <span class="nx">args</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
                <span class="nx">args</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
                <span class="nx">component</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">_components</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">})</span>

<span class="p">})</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 